<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerar favicon laranja</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 480px; margin: 2rem auto; padding: 0 1rem; }
    h1 { font-size: 1.25rem; }
    .preview { display: flex; gap: 1rem; align-items: center; margin: 1rem 0; }
    .preview img { border: 1px solid #ddd; border-radius: 4px; }
    button { padding: 0.5rem 1rem; background: #ff6b35; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; }
    button:hover { filter: brightness(1.1); }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    p { color: #666; font-size: 0.9rem; }
  </style>
</head>
<body>
  <h1>Favicon laranja (halter)</h1>
  <p>Carrega <code>halter.png</code>, troca o preto por laranja (#ff6b35) e gera 32×32 para favicon.</p>
  <div class="preview">
    <div>
      <strong>Original</strong><br />
      <img id="original" alt="halter original" width="64" height="64" />
    </div>
    <div>
      <strong>Laranja</strong><br />
      <img id="result" alt="halter laranja" width="32" height="32" />
    </div>
  </div>
  <button id="btn" disabled>Baixar halter-orange.png</button>
  <p style="margin-top: 1rem;">Salve o arquivo em <code>public/halter-orange.png</code> para usar como favicon. Ou rode <code>npm run favicon:recolor</code> para gerar direto.</p>

  <script>
    const ORANGE = [255, 107, 53];
    const BLACK_THRESHOLD = 45;
    const SIZE = 32;

    const originalImg = document.getElementById('original');
    const resultImg = document.getElementById('result');
    const btn = document.getElementById('btn');

    async function run() {
      let blob;
      try {
        const r = await fetch('/halter.png');
        if (!r.ok) throw new Error('halter.png não encontrado. Rode o dev server (npm run dev) e abra esta página.');
        blob = await r.blob();
      } catch (e) {
        alert(e.message);
        return;
      }

      const img = await createImageBitmap(blob);
      originalImg.src = URL.createObjectURL(blob);

      const full = document.createElement('canvas');
      full.width = img.width;
      full.height = img.height;
      const fctx = full.getContext('2d');
      fctx.drawImage(img, 0, 0);
      const fdata = fctx.getImageData(0, 0, full.width, full.height);
      const fd = fdata.data;

      for (let i = 0; i < fd.length; i += 4) {
        const r = fd[i], g = fd[i + 1], b = fd[i + 2], a = fd[i + 3];
        if (r <= BLACK_THRESHOLD && g <= BLACK_THRESHOLD && b <= BLACK_THRESHOLD && a > 0) {
          fd[i] = ORANGE[0];
          fd[i + 1] = ORANGE[1];
          fd[i + 2] = ORANGE[2];
        }
      }
      fctx.putImageData(fdata, 0, 0);

      const out = document.createElement('canvas');
      out.width = SIZE;
      out.height = SIZE;
      const octx = out.getContext('2d');
      octx.drawImage(full, 0, 0, full.width, full.height, 0, 0, SIZE, SIZE);

      const png = out.toDataURL('image/png');
      resultImg.src = png;

      btn.disabled = false;
      btn.onclick = () => {
        const a = document.createElement('a');
        a.href = png;
        a.download = 'halter-orange.png';
        a.click();
      };
    }

    run();
  </script>
</body>
</html>
